'use strict';var __awaiter=this&&this.__awaiter||function(a,b,c,d){function e(g){return g instanceof c?g:new c(function(f){f(g)})}return new (c||(c=Promise))(function(g,f){function h(l){try{k(d.next(l))}catch(n){f(n)}}function m(l){try{k(d["throw"](l))}catch(n){f(n)}}function k(l){l.done?g(l.value):e(l.value).then(h,m)}k((d=d.apply(a,b||[])).next())})},__generator=this&&this.__generator||function(a,b){function c(k){return function(l){return d([k,l])}}function d(k){if(g)throw new TypeError("Generator is already executing.");
for(;e;)try{if(g=1,f&&(h=k[0]&2?f["return"]:k[0]?f["throw"]||((h=f["return"])&&h.call(f),0):f.next)&&!(h=h.call(f,k[1])).done)return h;if(f=0,h)k=[k[0]&2,h.value];switch(k[0]){case 0:case 1:h=k;break;case 4:return e.label++,{value:k[1],done:!1};case 5:e.label++;f=k[1];k=[0];continue;case 7:k=e.ops.pop();e.trys.pop();continue;default:if(!(h=e.trys,h=0<h.length&&h[h.length-1])&&(6===k[0]||2===k[0])){e=0;continue}if(3===k[0]&&(!h||k[1]>h[0]&&k[1]<h[3]))e.label=k[1];else if(6===k[0]&&e.label<h[1])e.label=
h[1],h=k;else if(h&&e.label<h[2])e.label=h[2],e.ops.push(k);else{h[2]&&e.ops.pop();e.trys.pop();continue}}k=b.call(a,e)}catch(l){k=[6,l],f=0}finally{g=h=0}if(k[0]&5)throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}var e={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},g,f,h,m;return m={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(m[Symbol.iterator]=function(){return this}),m},__extends=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||
{__proto__:[]}instanceof Array&&function(d,e){d.__proto__=e}||function(d,e){for(var g in e)Object.prototype.hasOwnProperty.call(e,g)&&(d[g]=e[g])};return a(b,c)};return function(b,c){function d(){this.constructor=b}if("function"!==typeof c&&null!==c)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Strings=function(){function a(){}a.init=function(){var b=navigator.userLanguage||navigator.language;
b&&0===b.toLowerCase().indexOf("pt")&&(document.documentElement.setAttribute("lang","pt-br"),a.LandscapeWarning="O jogo funciona melhor no modo paisagem :)",a.Cancel="Cancelar",a.Clear="Limpar",a.Close="Fechar",a.Exit="Sair",a.Play="Jogar",a.Edit="Editar",a.Delete="Excluir",a.NextRound="Pr\u00f3xima Rodada",a.Finish="Terminar!",a.of="de",a.Round="Rodada ",a.point="ponto",a.points="pontos",a.Install="Instalar!",a.About="Sobre",a.PlayMusic="Tocar m\u00fasica",a.StopMusic="Parar m\u00fasica",a.Fullscreen=
"Tela Cheia",a.START="INICIAR",a.RULES="REGRAS",a.CREDITS="CR\u00c9DITOS",a.Victory="Sua pontua\u00e7\u00e3o final total foi {totalPoints}<br/>\n\t\t\t<br/>\n\t\t\t{regularPoints} pontos de aliens embarcados<br/>\n\t\t\t+<br/>\n\t\t\t{extraPoints} de b\u00f4nus por ",a.VictorySpeciesSingular=" \u00fanica esp\u00e9cie",a.VictorySpeciesPlural=" esp\u00e9cies diferentes",a.GameOverReposition="N\u00e3o \u00e9 permitido reposicionar os alien\u00edgenas!",a.GameOverFirstAvailable="Um novo alien\u00edgena deve sempre ser embarcado na primeira posi\u00e7\u00e3o dispon\u00edvel!",
a.GameOverReplace="N\u00e3o \u00e9 permitido substituir um alien\u00edgina j\u00e1 embarcado!",a.CreditsHTML='<h1 class="blue">GAME DESIGN</h2>\n\t\t\t<p>Vince Vader</p>\n\t\t\t<h1 class="green">PROGRAMA\u00c7\u00c3O</h2>\n\t\t\t<p>Carlos Rafael das Neves</p>\n\t\t\t<h1 class="orange">COORDENA\u00c7\u00c3O DE CRIA\u00c7\u00c3O</h2>\n\t\t\t<p>Eduardo Manente</p>\n\t\t\t<h1 class="red">COORDENA\u00c7\u00c3O DE PLANEJAMENTO</h2>\n\t\t\t<p>Eric de Carvalho</p>\n\t\t\t<h1 class="pink">LAYOUT E TRILHA SONORA</h2>\n\t\t\t<p>Camila Galastri Guedes</p>\n\t\t\t<p>Jo\u00e3o Pedro Rabelo</p>\n\t\t\t<p>Marcella Lizaso de Siqueira</p>\n\t\t\t<div class="insta">\n\t\t\t<h1>SIGA NO INSTA</h1>\n\t\t\t<p><a target="_blank" href="https://www.instagram.com/gamelab_espm/">@gamelab_espm</a></p>\n\t\t\t<p><a target="_blank" href="https://www.instagram.com/techespm/">@techespm</a></p>\n\t\t\t<p><a target="_blank" href="https://www.instagram.com/arenas_espm/">@arenas_espm</a></p>\n\t\t\t</div>',
a.DecimalSeparator=",",a.OppositeDecimalSeparator=".",a.Success="Sucesso!",a.Pause="Pausa",a.Restart="Reiniciar",a.Time="Tempo",a.Name="Nome")};a.LandscapeWarning="The game works better in landscape mode :)";a.OK="OK";a.Cancel="Cancel";a.Clear="Clear";a.Close="Close";a.Exit="Exit";a.Play="Play";a.Menu="Menu";a.Edit="Edit";a.Delete="Delete";a.NextRound="Next Round";a.Finish="Finish!";a.of="of";a.Round="Round ";a.Total="Total: ";a.point="point";a.points="points";a.Install="Install!";a.Oops="Oops\u2026";
a.Download="Download";a.About="About";a.PlayMusic="Play music";a.StopMusic="Stop music";a.Fullscreen="Fullscreen";a.START="START";a.RULES="RULES";a.CREDITS="CREDITS";a.Victory="Your final score was {totalPoints}<br/>\n\t<br/>\n\t{regularPoints} points for boarded aliens<br/>\n\t+<br/>\n\t{extraPoints} bonus points for ";a.VictorySpeciesSingular=" single species";a.VictorySpeciesPlural=" different species";a.GameOverReposition="Repositioning aliens is not allowed!";a.GameOverFirstAvailable="New aliens must always be boarded in the first available position!";
a.GameOverReplace="Replacing an already boarded alien is not allowed!";a.CreditsHTML='<h1 class="blue">GAME DESIGN</h2>\n\t<p>Vince Vader</p>\n\t<h1 class="green">PROGRAMMING</h2>\n\t<p>Carlos Rafael das Neves</p>\n\t<h1 class="orange">CREATIVE COORDINATION</h2>\n\t<p>Eduardo Manente</p>\n\t<h1 class="red">PLANNING COORDINATION</h2>\n\t<p>Eric de Carvalho</p>\n\t<h1 class="pink">LAYOUT AND SOUNDTRACK</h2>\n\t<p>Camila Galastri Guedes</p>\n\t<p>Jo\u00e3o Pedro Rabelo</p>\n\t<p>Marcella Lizaso de Siqueira</p>\n\t<div class="insta">\n\t<h1>FOLLOW ON INSTAGRAM</h1>\n\t<p><a target="_blank" href="https://www.instagram.com/gamelab_espm/">@gamelab_espm</a></p>\n\t<p><a target="_blank" href="https://www.instagram.com/techespm/">@techespm</a></p>\n\t<p><a target="_blank" href="https://www.instagram.com/arenas_espm/">@arenas_espm</a></p>\n\t</div>';
a.DecimalSeparator=".";a.OppositeDecimalSeparator=",";a.Success="Success!";a.Pause="Pause";a.Restart="Restart";a.Time="Time";a.Name="Name";return a}(),isIOSOrSafari=function(){if(0>=navigator.userAgent.indexOf("Chrome")&&0<=navigator.userAgent.indexOf("Safari")||0<=navigator.userAgent.indexOf("Mac")&&"ontouchend"in document)return!0;switch(navigator.platform){case "iPad Simulator":case "iPhone Simulator":case "iPod Simulator":case "iPad":case "iPhone":case "iPod":return!0}return!1}(),iconMarginEm=
.25,iconMarginCss="0.25em",smallMarginRem=.5,smallMarginCss="0.5rem",largeMarginRem=1,largeMarginCss="1rem",animationStartDelayMS=50,slowestAnimationTimeoutMS=1020,slowAnimationTimeoutMS=520,fastAnimationTimeoutMS=320,fastestAnimationTimeoutMS=120,blinkLastCounter=7,blinkSingleDurationMS=75,blinkTotalDurationMS=(blinkLastCounter+1)*blinkSingleDurationMS,baseWidth=1280,baseHeight=720,alienWidthRem=3.361930295,alienHeightRem=3.361930295,alienWidthCss=alienWidthRem+"rem",alienHeightCss=alienHeightRem+
"rem",baseFontSize=32,baseHeightFontUnits=baseHeight/baseFontSize|0,iconSize=32,Icon=function(){function a(){}a.change=function(b,c){b.setAttribute(a.DataId,c.toString());b.textContent=String.fromCharCode(c)};a.create=function(b,c,d){var e=document.createElement("span");e.className=d?"ui-icon no-margin":"ui-icon";a.change(e,b);c&&c.appendChild(e);return e};a.html=function(b,c){return'<span class="'+(c?"ui-icon no-margin":"ui-icon")+'" '+a.DataId+'="'+b+'">'+String.fromCharCode(b)+"</span>"};a.DataId=
"data-icon-id";a.ScrollThumb=59651;a.Accept=59650;a.Clear=59649;a.Back=59648;a.Ball=257;a.Goal=65793;a.Bomb=131329;a.Cucumber=196865;a.Edit=262401;a.Question=327937;a.DeviceH=16777473;a.DeviceV=16843009;a.Hand=16908545;a.Fullscreen=16974081;a.Restart=17039617;a.Open=17105153;a.AcceptGreen=33554689;a.ClearRed=33685761;a.Border=33882369;a.LineWidth0=50331905;a.LineWidth1=50397441;a.LineWidth2=50462977;a.LineWidth3=50528513;a.Eraser=67109121;a.Rainbow=67174657;a.Pause=67240193;a.Play=67305729;a.PlayGreen=
83886337;a.Exit=83951873;a.Menu=84017409;a.Download=84082945;a.Success=100663553;a.Error=100729089;a.Trophy=100794625;a.Clock=100860161;a.DeviceHI=100925697;a.DeviceVI=100991233;return a}(),FullscreenControl=function(){function a(){}a.requestFullscreen=function(b){b||(b=document.body);var c=!0,d=null;try{b.requestFullscreen?d=b.requestFullscreen():b.webkitRequestFullscreen?d=b.webkitRequestFullscreen():b.mozRequestFullScreen?d=b.mozRequestFullScreen():b.msRequestFullscreen?d=b.msRequestFullscreen():
c=!1}catch(e){c=!1}c||b===document.body?ignorePromise(d):a.requestFullscreen()};a.exitFullscreen=function(){var b=null;try{document.exitFullscreen?b=document.exitFullscreen():document.webkitExitFullscreen?b=document.webkitExitFullscreen():document.mozExitFullScreen?b=document.mozExitFullScreen():document.msExitFullscreen&&(b=document.msExitFullscreen())}catch(c){}ignorePromise(b)};Object.defineProperty(a,"fullscreenElement",{get:function(){var b=null;try{"fullscreenElement"in document&&(b=document.fullscreenElement),
!b&&"webkitFullscreenElement"in document&&(b=document.webkitFullscreenElement),!b&&"mozFullscreenElement"in document&&(b=document.mozFullscreenElement),!b&&"msFullscreenElement"in document&&(b=document.msFullscreenElement)}catch(c){}return b},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"onfullscreenchange",{get:function(){try{if("onfullscreenchange"in document)return document.onfullscreenchange;if("onwebkitfullscreenchange"in document)return document.onwebkitfullscreenchange;
if("onmozfullscreenchange"in document)return document.onmozfullscreenchange;if("onmsfullscreenchange"in document)return document.onmsfullscreenchange}catch(b){}return null},enumerable:!1,configurable:!0});Object.defineProperty(a,"onfullscreenchange",{set:function(b){try{"onfullscreenchange"in document&&(document.onfullscreenchange=b),"onwebkitfullscreenchange"in document&&(document.onwebkitfullscreenchange=b),"onmozfullscreenchange"in document&&(document.onmozfullscreenchange=b),"onmsfullscreenchange"in
document&&(document.onmsfullscreenchange=b)}catch(c){}},enumerable:!1,configurable:!0});a.toggleFullscreen=function(){a.fullscreenMode=!a.fullscreenMode};Object.defineProperty(a,"fullscreenMode",{get:function(){return!!a.fullscreenElement},set:function(b){b?a.requestFullscreen():a.exitFullscreen()},enumerable:!1,configurable:!0});return a}(),PointerHandler=function(){function a(b,c,d,e,g,f){void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=null);void 0===g&&(g=!0);void 0===f&&(f=null);this.documentTarget=
document.documentElement||document.body;this.element=b;this.downCallback=c;this.moveCallback=d;this.upCallback=e;this.boundExtraTouchStart=null;"onpointerdown"in b?(this.documentDownEvent="pointerdown",this.documentMoveEvent="pointermove",this.documentUpEvent="pointerup",this.documentCancelEvent="pointercancel",this.boundDocumentDown=this.pointerDown.bind(this),this.boundDocumentUp=this.pointerUp.bind(this),this.boundDocumentMove=this.pointerMove.bind(this),"ontouchstart"in b&&(this.boundExtraTouchStart=
this.extraTouchStart.bind(this))):"ontouchstart"in b?(this.documentDownEvent="touchstart",this.documentMoveEvent="touchmove",this.documentUpEvent="touchend",this.documentCancelEvent="touchcancel",this.boundDocumentDown=this.touchStart.bind(this),this.boundDocumentUp=this.touchEnd.bind(this),this.boundDocumentMove=this.touchMove.bind(this)):(this.documentDownEvent="mousedown",this.documentMoveEvent="mousemove",this.documentUpEvent="mouseup",this.documentCancelEvent=null,this.boundDocumentDown=this.mouseDown.bind(this),
this.boundDocumentUp=this.mouseUp.bind(this),this.boundDocumentMove=this.mouseMove.bind(this));this.lazy=g;this.outsidePointerHandler=f;this.boundExtraTouchStart&&b.addEventListener("touchstart",this.boundExtraTouchStart);b.addEventListener(this.documentDownEvent,this.boundDocumentDown);g||this.addSecondaryHandlers();this._captured=!1;this.pointerId=-1}a.prototype.destroy=function(){this.element&&(this.boundExtraTouchStart&&this.element.removeEventListener("touchstart",this.boundExtraTouchStart),
this.boundDocumentDown&&this.element.removeEventListener(this.documentDownEvent,this.boundDocumentDown));this.removeSecondaryHandlers();this.mouseUp({});zeroObject(this)};Object.defineProperty(a.prototype,"captured",{get:function(){return this._captured},enumerable:!1,configurable:!0});a.prototype.addSecondaryHandlers=function(){this.documentTarget&&(this.documentTarget.addEventListener(this.documentMoveEvent,this.boundDocumentMove,{capture:!0,passive:!1}),this.documentTarget.addEventListener(this.documentUpEvent,
this.boundDocumentUp,!0),this.documentCancelEvent&&this.documentTarget.addEventListener(this.documentCancelEvent,this.boundDocumentUp,!0))};a.prototype.removeSecondaryHandlers=function(){this.documentTarget&&(this.boundDocumentUp&&(this.documentTarget.removeEventListener(this.documentUpEvent,this.boundDocumentUp,!0),this.documentCancelEvent&&this.documentTarget.removeEventListener(this.documentCancelEvent,this.boundDocumentUp,!0)),this.boundDocumentMove&&this.documentTarget.removeEventListener(this.documentMoveEvent,
this.boundDocumentMove,!0))};a.prototype.extraTouchStart=function(b){if(b.target===this.element||this.outsidePointerHandler&&this.outsidePointerHandler(b))return cancelEvent(b)};a.prototype.pointerDown=function(b){if(0<=this.pointerId&&"mouse"!==b.pointerType)return cancelEvent(b);var c=this.mouseDown(b);this._captured&&(this.pointerId=b.pointerId);return c};a.prototype.pointerMove=function(b){if(this._captured&&b.pointerId===this.pointerId)return this.mouseMove(b)};a.prototype.pointerUp=function(b){if(this._captured&&
b.pointerId===this.pointerId)return this.pointerId=-1,this.mouseUp(b)};a.prototype.touchStart=function(b){if(!(1<b.touches.length))return 0<=this.pointerId&&this.touchEnd(b),this.pointerId=1,b.clientX=b.touches[0].clientX,b.clientY=b.touches[0].clientY,b=this.mouseDown(b),void 0===b&&(this.pointerId=-1),b};a.prototype.touchMove=function(b){if(this._captured&&!(1<b.touches.length))return b.clientX=b.touches[0].clientX,b.clientY=b.touches[0].clientY,this.mouseMove(b)};a.prototype.touchEnd=function(b){if(this._captured&&
!(0>this.pointerId))return this.pointerId=-1,this.mouseUp(b)};a.prototype.mouseDown=function(b){this.mouseUp(b);if(!b.button&&!View.fading&&(!b.target||b.target===this.element||this.outsidePointerHandler&&this.outsidePointerHandler(b))){if(this.downCallback&&!this.downCallback(b))return cancelEvent(b);this._captured=!0;this.lazy&&this.addSecondaryHandlers();return cancelEvent(b)}};a.prototype.mouseMove=function(b){if(this._captured)return this.moveCallback&&this.moveCallback(b),cancelEvent(b)};a.prototype.mouseUp=
function(b){if(this._captured)return this._captured=!1,this.lazy&&this.removeSecondaryHandlers(),this.upCallback&&this.upCallback(b),cancelEvent(b)};return a}(),Modal=function(){function a(b){var c=this;this.options=b;this.containerElement=document.createElement("div");this.containerElement.className="base-element modal-container";this.modalElement=document.createElement("div");this.modalElement.className=b.large?"modal large":"modal";b.error&&(this.modalElement.className+=" error");"string"===typeof b.html?
this.modalElement.innerHTML=b.html:this.modalElement.appendChild(b.html);this.containerElement.appendChild(this.modalElement);document.body.appendChild(this.containerElement);this.boundDocumentKeyDown=this.documentKeyDown.bind(this);document.addEventListener("keydown",this.boundDocumentKeyDown,!0);this.fading=!0;window.setTimeout(function(){if(b.onshowing)b.onshowing();c.resizeInternal();c.containerElement.classList.add("visible");window.setTimeout(function(){c.fading=!1;c.containerElement.onclick=
a.hide;View.pushHistoryStateIfNecessary();if(c.options.onshown)c.options.onshown()},slowAnimationTimeoutMS)},animationStartDelayMS)}Object.defineProperty(a,"visible",{get:function(){return!!a.modal},enumerable:!1,configurable:!0});Object.defineProperty(a,"currentModalElement",{get:function(){return a.modal?a.modal.modalElement:null},enumerable:!1,configurable:!0});a.show=function(b){if(a.modal)return!1;a.modal=new a(b);return!0};a.hide=function(){a.modal&&a.modal.hideInternal()};a.defaultCancelAction=
function(){a.modal&&a.modal.hideInternal()};a.windowResized=function(){a.modal&&a.modal.resizeInternal()};a.prototype.hideInternal=function(){var b=this;a.modal!==this||this.fading||this.options.onhiding&&!1===this.options.onhiding()||(document.removeEventListener("keydown",this.boundDocumentKeyDown,!0),this.fading=!0,this.containerElement.classList.remove("visible"),window.setTimeout(function(){a.modal=null;View.popHistoryStateIfNecessary();if(b.options.onhidden)b.options.onhidden();document.body.removeChild(b.containerElement);
zeroObject(b.options);zeroObject(b)},slowAnimationTimeoutMS))};a.prototype.documentKeyDown=function(b){"Escape"!==b.key&&27!==b.keyCode||this.hideInternal()};a.prototype.resizeInternal=function(){if(a.modal===this&&this.options.onresized)this.options.onresized()};a.modal=null;return a}(),Alien=function(){function a(b,c){if("number"===typeof b){if(b<a.KindMin||b>a.KindMax)throw Error("Invalid alien kind");this.kind=a.Kinds[b]}else this.kind=b;this.element=document.createElement("div");this.element.className=
"alien";this.element.style.width=alienWidthCss;this.element.style.height=alienHeightCss;this.element.style.backgroundImage="url("+this.kind.imageUrl+")";this.element.style.backgroundSize=this.kind.cols*alienWidthRem+"rem "+this.kind.rows*alienHeightRem+"rem";this.element.alien=this;this.paused=!1;this.frame=Math.random()*this.kind.frames;this.frameInteger=this.frame|0;this._placement=void 0===c?-1:c;this.updateDOM()}a.preloadAllImages=function(){for(var b=Array(a.Kinds.length),c=a.Kinds.length-1;0<=
c;c--)b[c]=preloadImage(a.Kinds[c].imageUrl);return Promise.all(b)};a.create=function(b,c,d){b===a.KindRandom&&(b=a.KindMax-a.KindMin+1,b=a.KindMin+(Math.random()*b*b*b|0)%b);d=new a(b,d);a.aliens.push(d);c&&c.appendChild(d.element);return d};a.destroyAll=function(){for(var b=a.aliens.length-1;0<=b;b--)a.aliens[b].destroy(!0);a.aliens.splice(0)};a.stepAll=function(b){b*=.012;for(var c=a.aliens,d=c.length-1;0<=d;d--)c[d].updateDOM(b)};a.fromElement=function(b){return b?b.alien||null:null};Object.defineProperty(a.prototype,
"placement",{get:function(){return this._placement},enumerable:!1,configurable:!0});a.prototype.updateDOM=function(b){if(!this.paused&&this.element){if(b){this.frame=(this.frame+b)%this.kind.frames;b=this.frame|0;if(this.frameInteger===b)return;this.frameInteger=b}else b=this.frameInteger;var c=this.kind.cols;this.element.style.backgroundPosition="-"+b%c*alienWidthRem+"rem -"+(b/c|0)*alienHeightRem+"rem"}};a.prototype.shrink=function(b){return __awaiter(this,void 0,void 0,function(){return __generator(this,
function(c){switch(c.label){case 0:return this.element?[4,delay((b||0)+animationStartDelayMS)]:[2];case 1:c.sent();if(!this.element)return[2];this.element.classList.remove("full-size");return[2,delay(slowAnimationTimeoutMS)]}})})};a.prototype.grow=function(b){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(c){switch(c.label){case 0:return this.element?[4,delay((b||0)+animationStartDelayMS)]:[2];case 1:c.sent();if(!this.element)return[2];this.element.classList.add("full-size");
return[2,delay(slowAnimationTimeoutMS)]}})})};a.prototype.destroy=function(b){this.element&&(this.element.alien=null,this.element.parentNode&&this.element.parentNode.removeChild(this.element));b||(b=a.aliens.indexOf(this),0<=b&&a.aliens.splice(b,1));zeroObject(this)};a.KindRandom=-1;a.KindBlack=0;a.KindBlue=1;a.KindGreen=2;a.KindIndigo=3;a.KindOrange=4;a.KindPink=5;a.KindRed=6;a.KindYellow=7;a.KindMin=a.KindBlack;a.KindMax=a.KindYellow;a.KindCount=a.KindYellow+1;a.Kinds=[{id:a.KindBlack,imageUrl:"assets/images/aliens/black.png",
rows:4,cols:3,frames:10},{id:a.KindBlue,imageUrl:"assets/images/aliens/blue.png",rows:4,cols:3,frames:12},{id:a.KindGreen,imageUrl:"assets/images/aliens/green.png",rows:5,cols:4,frames:20},{id:a.KindIndigo,imageUrl:"assets/images/aliens/indigo.png",rows:5,cols:5,frames:22},{id:a.KindOrange,imageUrl:"assets/images/aliens/orange.png",rows:3,cols:3,frames:9},{id:a.KindPink,imageUrl:"assets/images/aliens/pink.png",rows:6,cols:5,frames:29},{id:a.KindRed,imageUrl:"assets/images/aliens/red.png",rows:7,cols:6,
frames:40},{id:a.KindYellow,imageUrl:"assets/images/aliens/yellow.png",rows:4,cols:4,frames:16}];a.aliens=[];return a}(),View=function(){function a(){var b=this;this.destroy=function(c){return __awaiter(b,void 0,void 0,function(){return __generator(this,function(d){switch(d.label){case 0:if(!this.baseElement)return[3,3];this.baseElement.parentNode&&this.attached&&this.baseElement.parentNode.removeChild(this.baseElement);if(!this.attached)return[3,2];this.attached=!1;return[4,this.detach()];case 1:d.sent(),
d.label=2;case 2:this.destroyInternal(c),c||zeroObject(this),d.label=3;case 3:return[2]}})})};this.baseElement=document.createElement("div");this.baseElement.className="base-element";this.attached=!1}Object.defineProperty(a,"loading",{get:function(){return a._loading},set:function(b){a._loading!==b&&((a._loading=b)?(a.divLoading||(a.divLoading=document.createElement("div"),a.divLoading.style.display="none",document.body.appendChild(a.divLoading)),a.divLoadingTimeout&&clearTimeout(a.divLoadingTimeout),
a.divLoadingTimeout=window.setTimeout(function(){a.divLoadingTimeout=0;a.divLoading&&(a.divLoading.style.display="",a.divLoading.className="loading")},100)):a.divLoading&&(a.divLoadingTimeout&&(clearTimeout(a.divLoadingTimeout),a.divLoadingTimeout=0),document.body.removeChild(a.divLoading),a.divLoading=null))},enumerable:!1,configurable:!0});Object.defineProperty(a,"fading",{get:function(){return a._fading},enumerable:!1,configurable:!0});a.createInitialView=function(){return a.currentView||a._loading||
a._fading||a.viewStack.length?null:(new TitleView).fadeIn()};a.windowResized=function(b){b&&a.currentView&&a.currentView.resize()};a.windowHistoryStatePopped=function(b){a.windowHistoryStatePushed=!1;a.pushHistoryStateIfNecessary();Modal.visible&&Modal.defaultCancelAction()};a.pushHistoryStateIfNecessary=function(){a.windowHistoryStatePushed||a.currentView&&a.currentView instanceof TitleView&&!a._fading&&!Modal.visible||(a.windowHistoryStatePushed=!0,window.history.pushState({spaceTrain:!0},"Space Train"))};
a.popHistoryStateIfNecessary=function(){a.windowHistoryStatePushed&&window.history.back()};a.createHorizontalSpacer=function(b,c,d){var e=d?b.querySelector("#"+d):document.createElement("div");e.className="horizontal-spacer";e.style.width=c+"rem";d||b.appendChild(e);return e};a.createVerticalSpacer=function(b,c,d){var e=d?b.querySelector("#"+d):document.createElement("div");e.className="vertical-spacer";e.style.height=c+"rem";d||b.appendChild(e);return e};a.createButton=function(b,c,d){for(var e=
[],g=3;g<arguments.length;g++)e[g-3]=arguments[g];g=document.createElement("button");var f="string"===typeof c?c:"number"===typeof c?null:c.text||null,h="string"===typeof c?0:"number"===typeof c?c:c.imageId||0;h&&Icon.create(h,g,!f);g.setAttribute("type","button");d&&prepareButtonBlink(g,!1,d);b&&b.appendChild(g);f&&g.appendChild(document.createTextNode(f));if(e)for(f=0;f<e.length;f+=2)g.setAttribute(e[f],e[f+1]);return g};a.createBlackButton=function(b,c,d,e){for(var g=[],f=4;f<arguments.length;f++)g[f-
4]=arguments[f];f=[b,c,d];g&&g.length&&f.push.apply(f,g);f.push("class");f.push("black "+(e||""));return a.createButton.apply(this,f)};a.createWhiteButton=function(b,c,d,e){for(var g=[],f=4;f<arguments.length;f++)g[f-4]=arguments[f];f=[b,c,d];g&&g.length&&f.push.apply(f,g);f.push("class");f.push("white "+(e||""));return a.createButton.apply(this,f)};a.createBlueButton=function(b,c,d,e){for(var g=[],f=4;f<arguments.length;f++)g[f-4]=arguments[f];f=[b,c,d];g&&g.length&&f.push.apply(f,g);f.push("class");
f.push("blue "+(e||""));return a.createButton.apply(this,f)};a.createGreenButton=function(b,c,d,e){for(var g=[],f=4;f<arguments.length;f++)g[f-4]=arguments[f];f=[b,c,d];g&&g.length&&f.push.apply(f,g);f.push("class");f.push("green "+(e||""));return a.createButton.apply(this,f)};a.createOrangeButton=function(b,c,d,e){for(var g=[],f=4;f<arguments.length;f++)g[f-4]=arguments[f];f=[b,c,d];g&&g.length&&f.push.apply(f,g);f.push("class");f.push("orange "+(e||""));return a.createButton.apply(this,f)};a.createRedButton=
function(b,c,d,e){for(var g=[],f=4;f<arguments.length;f++)g[f-4]=arguments[f];f=[b,c,d];g&&g.length&&f.push.apply(f,g);f.push("class");f.push("red "+(e||""));return a.createButton.apply(this,f)};a.createPinkButton=function(b,c,d,e){for(var g=[],f=4;f<arguments.length;f++)g[f-4]=arguments[f];f=[b,c,d];g&&g.length&&f.push.apply(f,g);f.push("class");f.push("pink "+(e||""));return a.createButton.apply(this,f)};a.prototype.releaseResources=function(){};a.prototype.loadResources=function(){};a.prototype.resize=
function(){};a.prototype.fadeInFinished=function(){};a.prototype.finishFadeIn=function(b){var c=this;window.setTimeout(function(){c.resize();a.cover.classList.remove("visible");window.setTimeout(function(){a._fading=!1;a.popHistoryStateIfNecessary();document.body.removeChild(a.cover);c.fadeInFinished();b()},slowAnimationTimeoutMS)},animationStartDelayMS)};a.prototype.fadeIn=function(){var b=this;if(a._fading||a.currentView===this)return null;a._fading=!0;a.currentView=this;return new Promise(function(c){if(b.baseElement&&
!b.attached){a.main.appendChild(b.baseElement);b.attached=!0;var d=b.attach();if(d){d.then(function(){b.finishFadeIn(c)},function(e){console.error(e)});return}}b.finishFadeIn(c)})};a.prototype.fadeOut=function(b){var c=this;if(a._fading||a.currentView!==this)return null;a._fading=!0;return new Promise(function(d){document.body.appendChild(a.cover);window.setTimeout(function(){a.cover.classList.add("visible");window.setTimeout(function(){return __awaiter(c,void 0,void 0,function(){return __generator(this,
function(e){switch(e.label){case 0:return[4,this.destroy(b)];case 1:return e.sent(),b&&a.viewStack.push(this),a.currentView=null,a._fading=!1,a.pushHistoryStateIfNecessary(),d(),[2]}})})},slowAnimationTimeoutMS)},animationStartDelayMS)})};a.prototype.fadeTo=function(b,c){void 0===c&&(c=!1);return a._fading||a.currentView!==this?null:(c=this.fadeOut(c))?c.then(function(){var d=b().fadeIn();if(d)return d}):null};a.prototype.fadeToPrevious=function(){if(a._fading||a.currentView!==this||!a.viewStack.length)return null;
var b=this.fadeOut(!1);return b?b.then(function(){var c=a.viewStack.pop().fadeIn();if(c)return c}):null};a.main=document.getElementById("main");a.cover=document.getElementById("cover");a._loading=!1;a._fading=!1;a.mainLandscape=!1;a.currentView=null;a.viewStack=[];a.divLoading=null;a.divLoadingTimeout=0;a.windowHistoryStatePushed=!1;return a}(),CreditsView=function(a){function b(){var c=a.call(this)||this,d=View.createWhiteButton(c.baseElement,{imageId:Icon.Clear,text:Strings.Close},c.back.bind(c),
"small");d.style.position="absolute";d.style.left=smallMarginCss;d.style.top=smallMarginCss;d=document.createElement("div");d.className="text-center";d.style.paddingLeft=smallMarginCss;d.style.paddingRight=smallMarginCss;d.style.paddingBottom=smallMarginCss;d.innerHTML=Strings.CreditsHTML;c.baseElement.appendChild(d);c.textProtection=document.createElement("div");c.textProtection.className="text-protection";return c}__extends(b,a);b.prototype.attach=function(){return __awaiter(this,void 0,void 0,
function(){return __generator(this,function(c){document.body.insertBefore(this.textProtection,document.body.firstChild);return[2]})})};b.prototype.detach=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(c){document.body.removeChild(this.textProtection);return[2]})})};b.prototype.destroyInternal=function(c){};b.prototype.back=function(c){this.fadeToPrevious();return!0};return b}(View),GameView=function(a){function b(){var c=a.call(this)||this;c.baseElement.classList.add("text-center");
var d=View.createWhiteButton(c.baseElement,{imageId:Icon.Clear,text:Strings.Close},c.back.bind(c),"small");d.style.position="absolute";d.style.left=smallMarginCss;d.style.top=smallMarginCss;d=View.createBlueButton(c.baseElement,{imageId:Icon.Accept,text:Strings.NextRound},c.nextRound.bind(c),"small fade visible");d.setAttribute("disabled","disabled");d.style.position="absolute";d.style.right=smallMarginCss;d.style.top=smallMarginCss;c.nextRoundButton=d;d=document.createElement("div");d.style.pointerEvents=
"none";d.style.marginTop=alienHeightCss;d.style.height=alienHeightCss;c.shelf=d;c.baseElement.appendChild(d);d=document.createElement("div");d.className="train";c.alienRow=d;for(var e=b.MaximumAlienCount-1;0<=e;e--){var g=document.createElement("div");g.className="target";d.appendChild(g)}c.baseElement.appendChild(d);d=document.createElement("div");d.className="result-label";c.resultLabel=d;e=document.createElement("span");e.className="round";d.appendChild(e);c.resultLabelRound=e;g=Array(b.TotalRoundCount);
for(e=0;e<b.TotalRoundCount;e++){var f=document.createElement("span");f.className="marker";d.appendChild(f);g[e]=f;var h=document.createElement("span");h.className="points";f.appendChild(h)}c.resultLabelMarker=g;e=document.createElement("span");e.className="total";d.appendChild(e);c.resultLabelTotal=e;e=document.createElement("div");e.className="row2";e.innerHTML='<s>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</s><img src="assets/images/logo-small.png" /><s>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</s>';
d.appendChild(e);c.baseElement.appendChild(d);c.musicButton=View.createWhiteButton(c.baseElement,musicPlaying?Strings.StopMusic:Strings.PlayMusic,toggleMusic,"fade small visible");c.musicButton.style.position="absolute";c.musicButton.style.fontSize="0.5rem";c.musicButton.style.left="1.5rem";c.musicButton.style.bottom="1.5rem";c.baseElement.appendChild(c.musicButton);c.alive=!0;c.animating=!1;c.frameRequest=0;c.lastTime=0;c.pointerHandler=null;c.movingAlien=null;c.movingInitialX=0;c.movingInitialY=
0;c.round=0;c.points=0;c.lastPlacedAlien=0;c.originalAlienPlacement=-1;c.boundMouseDown=c.mouseDown.bind(c);c.boundMouseMove=c.mouseMove.bind(c);c.boundMouseUp=c.mouseUp.bind(c);c.boundOutsidePointerHandler=c.outsidePointerHandler.bind(c);c.boundRender=c.render.bind(c);return c}__extends(b,a);b.prototype.attach=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(c){musicButton=this.musicButton;updateMusicButton();this.lastTime=performance.now();this.alive=!0;
this.pointerHandler=new PointerHandler(this.baseElement,this.boundMouseDown,this.boundMouseMove,this.boundMouseUp,!1,this.boundOutsidePointerHandler);return[2]})})};b.prototype.detach=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(c){musicButton=null;this.alive=!1;this.pointerHandler&&(this.pointerHandler.destroy(),this.pointerHandler=null);this.frameRequest&&(cancelAnimationFrame(this.frameRequest),this.frameRequest=0);return[2]})})};b.prototype.destroyInternal=
function(c){c||Alien.destroyAll()};b.prototype.fadeInFinished=function(){this.frameRequest&&(cancelAnimationFrame(this.frameRequest),this.frameRequest=0);this.frameRequest=requestAnimationFrame(this.boundRender);this.restart()};b.prototype.back=function(c){this.fadeTo(function(){return new TitleView});return!0};b.prototype.displayAddedPoints=function(c,d){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(g){switch(g.label){case 0:d&&1<this.round&&this.round<=b.TotalRoundCount&&
(this.resultLabelMarker[this.round-2].firstChild.textContent=c.toString());if(!c)return[2];e=document.createElement("div");e.className="added-points";e.textContent="+ "+c+" "+(1===c?Strings.point:Strings.points)+"!";this.baseElement.appendChild(e);return[4,delay(animationStartDelayMS)];case 1:g.sent();if(!this.alive)return[2];e.classList.add("fading");return[4,delay(1500)];case 2:g.sent();if(!this.alive)return[2];this.baseElement.removeChild(e);return[2]}})})};b.prototype.generateNewAliens=function(c){return __awaiter(this,
void 0,void 0,function(){var d,e,g,f,h,m,k,l,n,q;return __generator(this,function(p){switch(p.label){case 0:d=b.MaximumAlienCount;e=this.shelf;g=e.getElementsByClassName("alien");f=75;if(!g.length)return[3,2];d=0;h=[];m=[];k=g.length-1;for(l=0;0<=k;k--,l+=f)if(n=Alien.fromElement(g[k]))n.paused||(h.push(n.shrink(l)),d++),m.push(n);this.resultLabel.classList.contains("visible")&&(this.resultLabel.classList.remove("visible"),h.push(delay(slowAnimationTimeoutMS)));return[4,Promise.all(h)];case 1:p.sent();
if(!this.alive)return[2];for(k=m.length-1;0<=k;k--)m[k].destroy();return[3,4];case 2:if(!this.resultLabel.classList.contains("visible"))return[3,4];this.resultLabel.classList.remove("visible");return[4,delay(slowAnimationTimeoutMS)];case 3:p.sent();if(!this.alive)return[2];p.label=4;case 4:this.displayAddedPoints(c,!0);q=Array(d);k=d-1;for(l=0;0<=k;k--,l+=f)n=Alien.create(Alien.KindRandom,e),q[k]=n.grow(l);for(k=b.TotalRoundCount;1<=k;k--)k>this.round?this.resultLabelMarker[k-1].classList.remove("done"):
this.resultLabelMarker[k-1].classList.add("done"),k>=this.round&&(this.resultLabelMarker[k-1].firstChild.textContent="");this.resultLabelRound.textContent=Strings.Round+this.round;this.resultLabelTotal.textContent=Strings.Total+this.points;return[4,delay(animationStartDelayMS)];case 5:p.sent();if(!this.alive)return[2];this.resultLabel.classList.add("visible");return[4,Promise.all(q)];case 6:p.sent();if(!this.alive)return[2];this.animating=!1;return[2]}})})};b.prototype.restart=function(){return __awaiter(this,
void 0,void 0,function(){var c,d,e,g,f;return __generator(this,function(h){switch(h.label){case 0:if(!this.alive||this.animating||this.movingAlien)return[2];this.nextRoundButton.setAttribute("disabled","disabled");this.nextRoundButton.replaceChild(document.createTextNode(Strings.NextRound),this.nextRoundButton.childNodes[1]);this.animating=!0;c=this.baseElement.getElementsByClassName("alien");d=[];e=c.length-1;for(g=0;0<=e;e--,g+=75)(f=Alien.fromElement(c[e]))&&!f.paused&&d.push(f.shrink(g));return[4,
Promise.all(d)];case 1:h.sent();if(!this.alive)return[2];Alien.destroyAll();this.animating=!1;this.lastPlacedAlien=this.points=this.round=0;this.originalAlienPlacement=-1;this.nextRound();return[2]}})})};b.prototype.showMessage=function(c,d){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(g){if(this.animating)return[2];this.animating=!0;return[2,new Promise(function(f){return __awaiter(e,void 0,void 0,function(){var h=this;return __generator(this,function(m){Modal.show({html:d,
error:c,onhidden:function(){h.alive&&(h.animating=!1,f())}});return[2]})})})]})})};b.prototype.gameOver=function(c){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(d){switch(d.label){case 0:return[4,this.showMessage(!0,c)];case 1:d.sent();if(!this.alive)return[2];this.animating=!0;return[4,delay(slowAnimationTimeoutMS)];case 2:d.sent();if(!this.alive)return[2];this.animating=!1;return[2,this.restart()]}})})};b.prototype.gameFinished=function(c,d,e){return __awaiter(this,
void 0,void 0,function(){return __generator(this,function(g){switch(g.label){case 0:return this.animating=!0,this.resultLabel.classList.remove("visible"),[4,delay(fastAnimationTimeoutMS)];case 1:g.sent();if(!this.alive)return[2];this.round++;return[4,this.displayAddedPoints(c,!1)];case 2:g.sent();if(!this.alive)return[2];this.animating=!1;return[4,this.showMessage(!1,Strings.Victory.replace("{totalPoints}",this.points.toString()).replace("{regularPoints}",(this.points-e).toString()).replace("{extraPoints}",
e.toString())+d+(1===d?Strings.VictorySpeciesSingular:Strings.VictorySpeciesPlural))];case 3:g.sent();if(!this.alive)return[2];this.restart();return[2]}})})};b.prototype.computeAddedPoints=function(){if(!this.alienRow)return 0;for(var c=this.alienRow.getElementsByClassName("alien"),d=Alien.KindRandom,e=0,g=0,f=c.length-1;0<=f;f--){var h=Alien.fromElement(c[f]);h&&(h=h.kind.id,d===h?e++:(g+=b.PointsPerSequence[e],e=1,d=h))}return g+b.PointsPerSequence[e]};b.prototype.computeExtraPoints=function(){if(!this.alienRow)return{typeCount:0,
extraPoints:0};var c=this.alienRow.getElementsByClassName("alien"),d=Array(Alien.KindCount);d.fill(0);for(var e=0,g=c.length-1;0<=g;g--){var f=Alien.fromElement(c[g]);f&&!d[f.kind.id]++&&e++}return{typeCount:e,extraPoints:3*e}};b.prototype.nextRound=function(){if(!this.alive||this.animating||this.movingAlien)return!1;var c=0;this.lastPlacedAlien&&(c=this.computeAddedPoints(),this.points+=c);if(this.lastPlacedAlien>=b.MaximumAlienCount){var d=this.computeExtraPoints(),e=d.typeCount;d=d.extraPoints;
this.points+=d;this.gameFinished(c+d,e,d);return!0}this.animating=!0;this.round++;this.nextRoundButton.setAttribute("disabled","disabled");this.generateNewAliens(c);return!0};b.prototype.mouseDown=function(c){if(!this.alive||this.animating)return!1;var d=c.clientX;c=c.clientY;for(var e=[this.shelf,this.alienRow],g=e.length-1;0<=g;g--){var f=e[g].getElementsByClassName("alien"),h=e[g].getBoundingClientRect();if(c>=h.top&&c<h.bottom&&f&&f.length)for(var m=f.length-1;0<=m;m--)if(h=f[m].getBoundingClientRect(),
d>=h.left&&d<h.right&&(h=Alien.fromElement(f[m]))&&h.element&&!h.paused)return h.element.classList.add("moving"),this.alienRow.classList.add("dragging"),this.movingInitialX=d,this.movingInitialY=c,this.movingAlien=h,this.originalAlienPlacement=h.placement,!0}return!1};b.prototype.mouseMove=function(c){this.movingAlien&&this.movingAlien.element&&(this.movingAlien.element.style.transform="translate("+(c.clientX-this.movingInitialX)+"px, "+(c.clientY-this.movingInitialY)+"px)")};b.prototype.mouseUp=
function(c){var d=this.movingAlien;if(d&&d.element){this.movingAlien=null;var e=this.alienRow,g=e.children,f=c.clientX;c=c.clientY;e.classList.remove("dragging");d.element.classList.remove("moving");d.element.style.transform="";e=e.getBoundingClientRect();if(c>=e.top&&c<e.bottom)for(c=g.length-1;0<=c;c--){var h=g[c];if(!(!h.classList.contains("target")||f<(e=h.getBoundingClientRect()).left||f>=e.right)){if(0<=this.originalAlienPlacement){this.originalAlienPlacement!==c&&this.gameOver(Strings.GameOverReposition);
break}if(this.lastPlacedAlien!==c){this.gameOver(Strings.GameOverFirstAvailable);break}if(h.childNodes.length){this.gameOver(Strings.GameOverReplace);break}d.paused=!0;d.element.style.visibility="hidden";Alien.create(d.kind,h,this.lastPlacedAlien).grow();this.lastPlacedAlien++;this.round<b.TotalRoundCount&&this.nextRoundButton.removeAttribute("disabled");this.lastPlacedAlien>=b.MaximumAlienCount&&(this.nextRoundButton.removeAttribute("disabled"),this.nextRoundButton.replaceChild(document.createTextNode(Strings.Finish),
this.nextRoundButton.childNodes[1]))}}}};b.prototype.outsidePointerHandler=function(c){return c.target&&"target"===c.target.className&&c.target.childNodes.length?!0:!1};b.prototype.render=function(c){if(this.alive){this.frameRequest=requestAnimationFrame(this.boundRender);var d=c-this.lastTime;this.lastTime=c;33<d&&(d=33);Alien.stepAll(d)}else this.frameRequest=0};b.TotalRoundCount=5;b.MaximumAlienCount=8;b.PointsPerSequence=[0,1,3,6,10,15,21,28,36];return b}(View),RulesView=function(a){function b(){var c=
a.call(this)||this,d=View.createWhiteButton(c.baseElement,{imageId:Icon.Clear,text:Strings.Close},c.back.bind(c),"small");d.style.position="absolute";d.style.left=smallMarginCss;d.style.top=smallMarginCss;return c}__extends(b,a);b.prototype.attach=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(c){return[2]})})};b.prototype.detach=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(c){return[2]})})};b.prototype.destroyInternal=
function(c){};b.prototype.back=function(c){this.fadeToPrevious();return!0};return b}(View),TitleView=function(a){function b(){var c=a.call(this)||this;c.baseElement.innerHTML='\n\t\t<div style="margin: 2em 0;">\n\t\t\t<img id="logo" src="assets/images/logo.png" alt="Logo" class="fade" style="width: 20rem;" />\n\t\t</div>\n\t\t<div id="subtitle" class="fade" style="margin: 2em 0 1em;">\n\t\t\t<s>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</s>\n\t\t\t&nbsp;\n\t\t\tBLOCKCHAIN GAME\n\t\t\t&nbsp;\n\t\t\t<s>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</s>\n\t\t</div>\n\t\t';
c.baseElement.className="text-center";c.logo=c.baseElement.querySelector("#logo");c.subtitle=c.baseElement.querySelector("#subtitle");c.startButton=View.createBlueButton(c.baseElement,Strings.START,c.start.bind(c),"fade","data-teste","1");c.startButton.style.marginBottom=largeMarginCss;c.baseElement.appendChild(document.createElement("br"));c.rulesButton=View.createOrangeButton(c.baseElement,Strings.RULES,c.rules.bind(c),"fade");c.rulesButton.style.marginBottom=largeMarginCss;c.baseElement.appendChild(document.createElement("br"));
c.creditsButton=View.createPinkButton(c.baseElement,Strings.CREDITS,c.credits.bind(c),"fade");c.creditsButton.style.marginBottom=largeMarginCss;c.musicButton=View.createWhiteButton(c.baseElement,musicPlaying?Strings.StopMusic:Strings.PlayMusic,toggleMusic,"fade small");c.musicButton.style.position="absolute";c.musicButton.style.left="1.5rem";c.musicButton.style.bottom="3rem";c.fullscreenButton=View.createWhiteButton(c.baseElement,Strings.Fullscreen,c.fullscreen.bind(c),"fade small");c.fullscreenButton.style.position=
"absolute";c.fullscreenButton.style.right="1.5rem";c.fullscreenButton.style.bottom="3rem";c.fadeSequence=0;c.fadeElements=null;c.fadeInterval=0;return c}__extends(b,a);b.prototype.attach=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(c){musicButton=this.musicButton;updateMusicButton();return[2]})})};b.prototype.detach=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(c){musicButton=null;this.fadeInterval&&(clearInterval(this.fadeInterval),
this.fadeInterval=0);return[2]})})};b.prototype.destroyInternal=function(c){};b.prototype.fadeInFinished=function(){this.startFadeSequence(1)};b.prototype.startFadeSequence=function(c,d){var e=this;if(!this.fadeSequence){var g=[this.logo,this.subtitle,this.startButton,this.rulesButton,this.creditsButton,this.musicButton,this.fullscreenButton];0>c&&g.reverse();this.fadeSequence=c;this.fadeElements=g;this.fadeInterval=window.setInterval(function(){var f=Math.abs(e.fadeSequence)-1;!e.fadeElements||f>=
e.fadeElements.length?(clearInterval(e.fadeInterval),e.fadeSequence=0,e.fadeElements=null,e.fadeInterval=0,d&&d()):(f=e.fadeElements[f],0<e.fadeSequence?(f.classList.add("visible"),e.fadeSequence++):(f.classList.remove("visible"),e.fadeSequence--))},100)}};b.prototype.start=function(c){var d=this;if(Modal.visible||this.fadeSequence)return!1;this.startFadeSequence(-1,function(){return d.fadeTo(function(){return new GameView})});return!0};b.prototype.rules=function(c){var d=this;if(this.fadeSequence)return!1;
this.startFadeSequence(-1,function(){return d.fadeTo(function(){return new RulesView},!0)});return!0};b.prototype.credits=function(c){var d=this;if(this.fadeSequence)return!1;this.startFadeSequence(-1,function(){return d.fadeTo(function(){return new CreditsView},!0)});return!0};b.prototype.fullscreen=function(c){FullscreenControl.toggleFullscreen();return!0};return b}(View),scaleFactor=-1,widthCss=0,heightCss=0,baseLeftCss=0,baseTopCss=0,fontSize=0,fontSizeCss="0px",musicPlaying=!0,bgMusic=document.getElementById("bg-music"),
musicButton=null,installationPrompt=null,landscapeWarning=null;function ignorePromise(a){try{var b=function(){};a&&a.then&&a.then(b,b)}catch(c){}}function cancelEvent(a){a&&("isCancelled"in a&&(a.isCancelled=!0),"preventDefault"in a&&a.preventDefault(),"stopPropagation"in a&&a.stopPropagation());return!1}function format2(a){return 10>a?"0"+a:a.toString()}function rem2Px(a){return fontSize*a+"px"}function rem2PxNumber(a){return fontSize*a}function smoothStep(a){return a*a*(3-2*a)}
function delay(a){return new Promise(function(b){return window.setTimeout(b,a)})}function handleBlink(a){var b=a[0],c=a[1];0<b&&b<blinkLastCounter?(c.style.visibility=b&1?"":"hidden",a[0]=b+1):abortBlink(c)}function abortBlink(a){if(a){var b=a.getAttribute("data-blink-interval");b&&(a.setAttribute("data-blink-interval",""),(b=parseInt(b))&&clearInterval(b),a.style.visibility="")}}
function blink(a){a&&(abortBlink(a),a.style.visibility="hidden",a.setAttribute("data-blink-interval",window.setInterval(handleBlink,blinkSingleDurationMS,[1,a]).toString()))}function prepareButtonBlink(a,b,c){a.onclick=function(d){View.loading||View.fading||!b&&Modal.visible||!c(d)||blink(a)}}function zeroObject(a){for(var b in a)switch(typeof a[b]){case "function":break;case "boolean":a[b]=!1;break;case "number":a[b]=0;break;default:var c=a[b];Array.isArray(c)&&c.fill(null);a[b]=null}}
function adjustWindowSize(){widthCss=window.innerWidth;heightCss=window.innerHeight;document.documentElement&&"clientWidth"in document.documentElement&&(widthCss=document.documentElement.clientWidth,heightCss=document.documentElement.clientHeight);if(isIOSOrSafari){var a=null;document.documentElement&&"getBoundingClientRect"in document.documentElement?a=document.documentElement.getBoundingClientRect():"getBoundingClientRect"in document.body&&(a=document.body.getBoundingClientRect());a&&(widthCss=
a.right-a.left,heightCss=a.bottom-a.top)}a="scale("+Math.ceil(.25*widthCss)+","+Math.ceil(.25*heightCss)+")";var b=View.cover.style;b.oTransform=a;b.msTransform=a;b.mozTransform=a;b.webkitTransform=a;b.transform=a;a=scaleFactor;if(widthCss/heightCss>=baseWidth/baseHeight){var c=heightCss;scaleFactor=heightCss/baseHeight;b=widthCss}else b=widthCss,scaleFactor=widthCss/baseWidth,c=baseHeight*scaleFactor;baseLeftCss=.5*(widthCss-b)|0;0>baseLeftCss&&(baseLeftCss=0);baseTopCss=.5*(heightCss-c)|0;0>baseTopCss&&
(baseTopCss=0);View.main.style.left=baseLeftCss+"px";View.main.style.top=baseTopCss+"px";widthCss<=heightCss?landscapeWarning||(landscapeWarning=document.createElement("div"),landscapeWarning.style.pointerEvents="none",landscapeWarning.style.textAlign="center",landscapeWarning.style.position="absolute",landscapeWarning.style.left="0",landscapeWarning.style.top=smallMarginCss,landscapeWarning.style.width="100%",landscapeWarning.style.zIndex="9999",landscapeWarning.textContent=Strings.LandscapeWarning,
document.body.appendChild(landscapeWarning)):landscapeWarning&&(document.body.removeChild(landscapeWarning),landscapeWarning=null);View.main.style.width=b+"px";View.main.style.height=c+"px";scaleFactor!==a?(fontSize=c/baseHeightFontUnits|0,fontSizeCss=fontSize+"px",document.documentElement&&(document.documentElement.style.fontSize=fontSizeCss),document.body.style.fontSize=fontSizeCss,View.windowResized(!0)):View.windowResized(!1);Modal.windowResized()}
function beforeInstallPrompt(a){"preventDefault"in a&&a.preventDefault();installationPrompt=a}function toggleMusic(a){musicPlaying===bgMusic.paused&&(musicPlaying=!musicPlaying);musicPlaying?(musicPlaying=!1,bgMusic.pause()):(musicPlaying=!0,bgMusic.play());a.target&&a.target.tagName&&(a.target.textContent=musicPlaying?Strings.StopMusic:Strings.PlayMusic);return!0}function updateMusicButton(){musicButton&&(musicButton.textContent=musicPlaying?Strings.StopMusic:Strings.PlayMusic)}
var fullscreenChangedTimeout=0;function fullscreenChanged(a){fullscreenChangedTimeout&&(clearTimeout(fullscreenChangedTimeout),fullscreenChangedTimeout=0);try{FullscreenControl.fullscreenMode?fullscreenChangedTimeout=setTimeout(fullscreenChangedHandler,150):fullscreenChangedHandler()}catch(b){}}
function fullscreenChangedHandler(){fullscreenChangedTimeout=0;if(screen.mozLockOrientation&&screen.mozUnlockOrientation)try{if(FullscreenControl.fullscreenMode){if(screen.mozLockOrientation("landscape-primary"))return}else if(screen.mozUnlockOrientation())return}catch(a){}if(screen.msLockOrientation&&screen.msUnlockOrientation)try{if(FullscreenControl.fullscreenMode){if(screen.msLockOrientation("landscape-primary"))return}else if(screen.msUnlockOrientation())return}catch(a){}if(screen.orientation&&
screen.orientation.lock&&screen.orientation.unlock)try{ignorePromise(FullscreenControl.fullscreenMode?screen.orientation.lock("landscape-primary"):screen.orientation.unlock())}catch(a){}}function preloadImage(a){return new Promise(function(b){var c=document.createElement("img");c.onload=function(){c.style.display="none";c.style.position="absolute";c.style.width="0";c.style.height="0";c.style.zIndex="-1";b()};c.onerror=function(){return b()};c.setAttribute("src",a)})}
function setup(){function a(){View.loading=!1;musicPlaying=!bgMusic.paused;bgMusic.onplay=function(){musicPlaying=!0;updateMusicButton()};bgMusic.onpause=function(){musicPlaying=!1;updateMusicButton()};View.createInitialView()}Strings.init();View.loading=!0;"serviceWorker"in navigator&&window.addEventListener("beforeinstallprompt",beforeInstallPrompt);window.onpopstate=View.windowHistoryStatePopped;window.onresize=adjustWindowSize;adjustWindowSize();FullscreenControl.onfullscreenchange=fullscreenChanged;
Alien.preloadAllImages().then(a,a)}window.spacetrainStepMAIN=!0;window.spacetrainCheckSetup&&window.spacetrainCheckSetup();
